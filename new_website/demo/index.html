<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NormCode PPT Client - AI-powered presentation generation tool">
    <meta name="theme-color" content="#1da1f2">
    <meta property="og:title" content="PsylensAI | PPT Client">
    <meta property="og:description" content="AI-powered presentation generation with real-time progress tracking">
    <meta property="og:type" content="website">
    <title>PsylensAI | PPT Client</title>
    <link rel="icon" type="image/png" href="../assets/images/logo.png">

    <!-- Shared site fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Shared site CSS (for navigation bar + footer) -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/responsive.css">

    <!-- Demo-specific CSS Modules -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/sections.css">
    <link rel="stylesheet" href="css/status.css">
    <link rel="stylesheet" href="css/files.css">
    <link rel="stylesheet" href="css/modal.css">
</head>
<body>
    <!-- Navigation loaded by load-nav.js -->

    <!-- 3-panel layout -->
    <div class="demo-container">
        <!-- Left Panel â€” Configuration -->
        <div class="panel">
            <h2 class="panel-title">âš™ï¸ é…ç½®</h2>
            <div class="panel-content">
                <div class="server-config">
                    <input type="text" id="serverUrl" value="http://115.191.31.222:8081" placeholder="æœåŠ¡å™¨åœ°å€">
                    <button class="btn btn-outline btn-sm" onclick="connect()">è¿æ¥</button>
                </div>

                <div class="form-group">
                    <label>è®¡åˆ’æ–¹æ¡ˆ</label>
                    <select id="planSelect" disabled>
                        <option value="">-- è¯·å…ˆè¿æ¥æœåŠ¡å™¨ --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>LLM æ¨¡å‹</label>
                    <select id="llmModel">
                        <option value="qwen-plus">Qwen Plus</option>
                        <option value="qwen-turbo">Qwen Turbo</option>
                    </select>
                </div>

                <!-- Basic Inputs -->
                <div class="section open">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>ğŸ“ åŸºæœ¬è¾“å…¥ <span id="inputsStatus" class="inputs-status"></span></span>
                        <span class="section-toggle">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>ä¸»é¢˜ *</label>
                            <input type="text" id="topic" value="æœºå™¨å­¦ä¹ åŸºç¡€" onchange="markInputsModified()">
                        </div>
                        <div class="form-group">
                            <label>ç›®æ ‡å—ä¼—</label>
                            <input type="text" id="audience" value="æŠ€æœ¯åˆå­¦è€…" onchange="markInputsModified()">
                        </div>
                        <div class="form-group">
                            <label>æœŸæœ›é•¿åº¦</label>
                            <input type="text" id="length" value="åŒ…æ‹¬æ ‡é¢˜å’Œé—®ç­”åœ¨å†…çš„6å¼ å¹»ç¯ç‰‡" onchange="markInputsModified()">
                        </div>
                        <div class="section-actions">
                            <button class="btn btn-primary btn-sm" id="saveInputsBtn" onclick="saveInputsToBackend()">
                                âœ“ ç¡®å®šä¿å­˜è¾“å…¥
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Content References -->
                <div class="section open" id="contentSection">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>ğŸ“„ å†…å®¹å‚è€ƒ <span id="contentCount" class="ref-count"></span></span>
                        <span class="section-toggle">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="uploaded-files" id="contentFiles"></div>
                        <div class="file-upload-area"
                             ondrop="handleDrop(event, 'content')"
                             ondragover="handleDragOver(event)"
                             ondragleave="handleDragLeave(event)"
                             onclick="document.getElementById('contentInput').click()">
                            <input type="file" id="contentInput" multiple hidden onchange="handleFiles(event, 'content')">
                            â• æ·»åŠ å†…å®¹æ–‡ä»¶<br>
                            <small class="muted">.md, .txt, .json</small>
                        </div>
                    </div>
                </div>

                <!-- Template References -->
                <div class="section open" id="templateSection">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>ğŸ–¼ï¸ å¹»ç¯ç‰‡æ¨¡æ¿ <span id="templateCount" class="ref-count"></span></span>
                        <span class="section-toggle">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="uploaded-files" id="templateFiles"></div>
                        <div class="file-upload-area"
                             ondrop="handleDrop(event, 'template')"
                             ondragover="handleDragOver(event)"
                             ondragleave="handleDragLeave(event)"
                             onclick="document.getElementById('templateInput').click()">
                            <input type="file" id="templateInput" multiple hidden onchange="handleFiles(event, 'template')">
                            â• æ·»åŠ HTMLæ¨¡æ¿<br>
                            <small class="muted">.html</small>
                        </div>
                    </div>
                </div>

                <!-- Style Guide References -->
                <div class="section open" id="styleSection">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>ğŸ¨ æ ·å¼æŒ‡å— <span id="styleCount" class="ref-count"></span></span>
                        <span class="section-toggle">â–¶</span>
                    </div>
                    <div class="section-content">
                        <div class="uploaded-files" id="styleFiles"></div>
                        <div class="file-upload-area"
                             ondrop="handleDrop(event, 'style')"
                             ondragover="handleDragOver(event)"
                             ondragleave="handleDragLeave(event)"
                             onclick="document.getElementById('styleInput').click()">
                            <input type="file" id="styleInput" multiple hidden onchange="handleFiles(event, 'style')">
                            â• æ·»åŠ æ ·å¼æŒ‡å—<br>
                            <small class="muted">.css, .md, .txt</small>
                        </div>
                    </div>
                </div>

                <div class="panel-footer">
                    <button class="btn btn-outline btn-block" onclick="previewInputs()">ğŸ‘ï¸ é¢„è§ˆè¾“å…¥</button>
                    <button class="btn btn-primary" id="startBtn" onclick="startRun()" disabled>ğŸš€ å¼€å§‹ç”Ÿæˆ</button>
                </div>
            </div>
        </div>

        <!-- Middle Panel â€” Execution -->
        <div class="panel">
            <h2 class="panel-title">ğŸ“Š æ‰§è¡ŒçŠ¶æ€</h2>
            <div class="panel-content">
                <div class="status-bar">
                    <span class="status-dot" id="statusDot"></span>
                    <span class="status-text" id="statusText">æœªè¿æ¥</span>
                    <span class="run-id" id="runId"></span>
                </div>

                <div class="progress-section">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">0 / 0 æ¬¡æ¨ç†</div>
                </div>

                <div class="log-section">
                    <h3 class="section-label">ğŸ“‹ äº‹ä»¶æ—¥å¿—</h3>
                    <div class="events-log" id="eventsLog">
                        <div class="placeholder">äº‹ä»¶å°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
                    </div>
                </div>

                <div class="output-section">
                    <h3 class="section-label section-label--success">
                        ğŸ“¦ æœ€ç»ˆè¾“å‡º <span class="label-hint">(productions/output/)</span>
                    </h3>
                    <div class="files-grid" id="finalOutputs">
                        <div class="placeholder">æœ€ç»ˆæ¼”ç¤ºæ–‡ç¨¿æ–‡ä»¶å°†åœ¨è¿™é‡Œæ˜¾ç¤º</div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>ğŸ”§ ä¸­é—´æ–‡ä»¶</span>
                        <span class="section-toggle">â–¶</span>
                    </div>
                    <div class="section-content section-content--compact">
                        <div class="files-grid files-grid--scroll" id="intermediateFiles">
                            <div class="placeholder">ä¸­é—´æ–‡ä»¶ï¼ˆåˆ†æã€å¤§çº²ã€å¹»ç¯ç‰‡...ï¼‰</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel â€” File Browser -->
        <div class="panel">
            <h2 class="panel-title">ğŸ“ æ–‡ä»¶æµè§ˆå™¨</h2>
            <div class="panel-content">
                <div class="inspector-tree" id="fileTree">
                    <div class="placeholder placeholder--spaced">
                        <div>ğŸ“‚ å·¥ä½œç©ºé—´æ–‡ä»¶</div>
                        <small>ä¿å­˜è¾“å…¥æˆ–å¯åŠ¨è¿è¡Œåï¼Œæ–‡ä»¶å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</small>
                    </div>
                </div>
                <div class="panel-footer--compact">
                    <button class="btn btn-outline btn-sm btn-block" onclick="refreshInspector()">ğŸ”„ åˆ·æ–°</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Preview Modal -->
    <div id="previewModal" class="modal" onclick="if(event.target===this)closePreview()">
        <div class="modal-content modal-content--wide">
            <div class="modal-header">
                <span>ğŸ“‹ è¾“å…¥é¢„è§ˆï¼ˆäº¤äº’å¼ï¼‰</span>
                <button class="btn btn-sm btn-outline" onclick="closePreview()">âœ•</button>
            </div>
            <div class="modal-body">
                <div id="previewJson"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="copyPreview()">ğŸ“‹ å¤åˆ¶å®Œæ•´JSON</button>
                <button class="btn btn-primary btn-auto" onclick="closePreview(); startRun();">ğŸš€ ä½¿ç”¨æ­¤è¾“å…¥è¿è¡Œ</button>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div id="filePreviewModal" class="modal" onclick="if(event.target===this)closeFilePreview()">
        <div class="modal-content">
            <div class="modal-header">
                <span id="filePreviewTitle">ğŸ“„ æ–‡ä»¶é¢„è§ˆ</span>
                <div>
                    <button class="btn btn-sm btn-outline" onclick="togglePreviewMode()">ğŸ–¼ï¸ æ¸²æŸ“è§†å›¾</button>
                    <button class="btn btn-sm btn-outline" onclick="closeFilePreview()">âœ•</button>
                </div>
            </div>
            <div class="modal-body">
                <div id="filePreviewContent" class="file-preview-container"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="copyFilePreview()">ğŸ“‹ å¤åˆ¶å†…å®¹</button>
                <button class="btn btn-outline" onclick="closeFilePreview()">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- JS Modules -->
    <script src="js/state.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/files.js"></script>
    <script src="js/server.js"></script>
    <script src="js/inputs.js"></script>
    <script src="js/run.js"></script>
    <script src="js/events.js"></script>
    <script src="js/outputs.js"></script>
    <script src="js/preview.js"></script>
    <script src="js/init.js"></script>

    <!-- Shared navigation (i18n + nav) -->
    <script src="../js/i18n.js"></script>
    <script src="../js/nav.js"></script>
    <script>
        i18n.init({
            en: {
                nav: {
                    brandText: 'Psylens.AI', home: 'Home', docs: 'Documentation',
                    overview: 'Overview', syntax: 'Syntax Reference', execution: 'Execution Model',
                    compilation: 'Compilation', examples: 'Examples', demo: 'Demo', about: 'About',
                    features: 'Features'
                },
                footer: {
                    tagline: 'Structured AI Planning That You Can Audit',
                    paper: 'Research Paper', contact: 'Contact',
                    office: 'TIMETABLE GBA Youth Innovation Base, Nansha, Guangzhou'
                }
            },
            zh: {
                nav: {
                    brandText: 'å¿ƒé•œæ™º', home: 'é¦–é¡µ', docs: 'æ–‡æ¡£',
                    overview: 'æ¦‚è¿°', syntax: 'è¯­æ³•å‚è€ƒ', execution: 'æ‰§è¡Œæ¨¡å‹',
                    compilation: 'ç¼–è¯‘æµç¨‹', examples: 'ç¤ºä¾‹', demo: 'æ¼”ç¤º', about: 'å…³äº',
                    features: 'åŠŸèƒ½'
                },
                footer: {
                    tagline: 'å¯å®¡è®¡çš„ç»“æ„åŒ–AIè§„åˆ’',
                    paper: 'ç ”ç©¶è®ºæ–‡', contact: 'è”ç³»æˆ‘ä»¬',
                    office: 'å¹¿å·å¸‚å—æ²™åŒºé»„é˜é•‡æµ·æ»¨è·¯åˆ›äº«æ¹¾4æ ‹TIMETABLEç²¤æ¸¯æ¾³é’åˆ›åŸºåœ°'
                }
            }
        });
    </script>
</body>
</html>
