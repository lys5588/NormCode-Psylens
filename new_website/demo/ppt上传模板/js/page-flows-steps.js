/**
 * Page-Flows Step Labels — PPT Template variant (plan c1cc3210 / 模板生成ppt_v1)
 *
 * Maps raw concept_name / flow_index values emitted by the server to human-readable
 * Chinese labels shown in the execution timeline.
 *
 * Source of truth: steps.txt (captured from a live run of this plan).
 */

// ---- Plan-specific step name translation ----
const STEP_LABELS = {
    // ── Content reference loading ──────────────────────────────────────────
    '[内容参考]':                                                            '加载内容参考',
    '{加载的内容}':                                                          '加载内容文件',
    '*. %>([内容参考元数据]) %<({加载的内容}) %:({当前内容元数据':           '处理每个内容参考',
    '{所有内容参考}':                                                        '汇总内容参考',

    // ── Style reference loading ────────────────────────────────────────────
    '[风格参考]':                                                            '加载风格参考',
    '{加载的风格}':                                                          '加载风格文件',
    '*. %>([风格参考元数据]) %<({加载的风格}) %:({当前风格元数据':           '处理每个风格参考',
    '{所有风格参考}':                                                        '汇总风格参考',

    // ── Requirements analysis ──────────────────────────────────────────────
    '{需求分析}':                                                            '分析需求',
    '{相对路径：中间产物/需求分析.json}':                                    '准备路径：需求分析',
    '{已保存的需求分析}':                                                    '保存需求分析',

    // ── Template raw data ──────────────────────────────────────────────────
    '{模板原始数据}':                                                        '提取模板原始数据',
    '{相对路径：模板原始数据.json}':                                         '准备路径：模板原始数据',
    '{已保存的模板原始数据}':                                                '保存模板原始数据',

    // ── Per-page analysis loop ─────────────────────────────────────────────
    '[页面列表]':                                                            '获取页面列表',
    '[所有单页总结]':                                                        '分析所有页面',
    '{结构特征}':                                                            '分析结构特征',
    '{页面意图}':                                                            '分析页面意图',
    '{页面分析}':                                                            '生成页面分析',
    '{单页总结}':                                                            '生成单页总结',
    '{页面分析相对路径}':                                                    '准备路径：页面分析',
    '{已保存的页面分析}':                                                    '保存页面分析',
    '*. %>([页面列表]) %<({单页总结}) %:({当前页面':                         '处理每个页面',

    // ── Overview & outline ─────────────────────────────────────────────────
    '{简化概览}':                                                            '生成简化概览',
    '{相对路径：简化概览.json}':                                             '准备路径：简化概览',
    '{已保存的简化概览}':                                                    '保存简化概览',
    '{演示大纲}':                                                            '生成演示大纲',
    '{相对路径：中间产物/演示大纲.json}':                                    '准备路径：演示大纲',
    '{已保存的演示大纲}':                                                    '保存演示大纲',

    // ── Template plan & outline alignment ─────────────────────────────────
    '{模板计划}':                                                            '制定模板计划',
    '{相对路径：中间产物/模板计划.json}':                                    '准备路径：模板计划',
    '{已保存的模板计划}':                                                    '保存模板计划',
    '{对齐大纲}':                                                            '对齐演示大纲',
    '{相对路径：中间产物/对齐大纲.json}':                                    '准备路径：对齐大纲',
    '{已保存的对齐大纲}':                                                    '保存对齐大纲',

    // ── Base presentation generation ───────────────────────────────────────
    '{相对路径：基础演示文稿.pptx}':                                         '准备路径：基础演示文稿',
    '{基础演示文稿输出路径}':                                                '设定基础演示文稿路径',
    '{基础演示文稿}':                                                        '生成基础演示文稿',

    // ── Per-page content fill loop ─────────────────────────────────────────
    '[大纲页面列表]':                                                        '获取大纲页面列表',
    '[所有页面内容]':                                                        '填充所有页面内容',
    '{页面分析路径}':                                                        '获取页面分析路径',
    '{此页分析}':                                                            '读取此页分析',
    '{分析简化版本}':                                                        '简化分析内容',
    '{可更改元素映射}':                                                      '映射可更改元素',
    '{页面内容草稿}':                                                        '生成页面内容草稿',
    '{页面文本内容}':                                                        '生成页面文本内容',
    '{映射页面文本内容}':                                                    '映射页面文本内容',
    '{页面内容相对路径}':                                                    '准备路径：页面内容',
    '{已保存的页面内容}':                                                    '保存页面内容',
    '*. %>([大纲页面列表]) %<({映射页面文本内容}) %:({当前大纲页面':         '处理每个大纲页面',

    // ── Final presentation assembly ────────────────────────────────────────
    '{所有替换计划}':                                                        '汇总替换计划',
    '{基础演示文稿路径}':                                                    '获取基础演示文稿路径',
    '{相对路径：最终演示文稿.pptx}':                                         '准备路径：最终演示文稿',
    '{最终演示文稿输出路径}':                                                '设定最终输出路径',
    '{最终演示文稿}':                                                        '生成最终演示文稿',

    // ── Optimisation pass ──────────────────────────────────────────────────
    '{最终演示文稿路径2}':                                                   '获取最终演示文稿路径',
    '{相对路径：优化后演示文稿.pptx}':                                       '准备路径：优化后演示文稿',
    '{优化后输出路径}':                                                      '设定优化输出路径',
    '{优化后的演示文稿}':                                                    '优化演示文稿',

    // ── Template overview ──────────────────────────────────────────────────
    '{模板概览输出}':                                                        '准备模板概览输出',
    '{模板概览}':                                                            '生成模板概览',
};

function translateStepName(raw) {
    if (!raw) return raw;
    if (STEP_LABELS[raw]) return STEP_LABELS[raw];
    // Prefix match — handles loop expressions that may be truncated on either end
    for (const key of Object.keys(STEP_LABELS)) {
        if (raw.startsWith(key) || key.startsWith(raw)) return STEP_LABELS[key];
    }
    return raw;
}
