{
  "metadata": {
    "description": "Execute Python script function that returns a list. Each list element is wrapped individually to enable axis creation in TVA.",
    "inputs": {
      "vertical": {
        "script_path": "Path to Python script file (perception-wrapped, stripped at runtime)"
      },
      "horizontal": {
        "data": "Runtime data passed as kwargs (value concept has perceptual sign, MVP perceives it)"
      }
    },
    "outputs": {
      "type": "ListLiteral",
      "description": "List of individually wrapped literal elements - enables axis creation"
    }
  },
  "env_spec": {
    "tools": [
      {
        "tool_name": "python_interpreter",
        "affordances": [
          {
            "affordance_name": "create_function_executor",
            "call_code": "result = tool.create_function_executor(script_code=params['script'], function_name=params['function_name'])"
          }
        ]
      },
      {
        "tool_name": "file_system",
        "affordances": [
          {
            "affordance_name": "read_now",
            "call_code": "result = tool.read(params['path'])"
          }
        ]
      },
      {
        "tool_name": "formatter_tool",
        "affordances": [
          {
            "affordance_name": "extract_content",
            "call_code": "result = params['data']['content']"
          },
          {
            "affordance_name": "wrap_list",
            "call_code": "result = tool.wrap_list"
          }
        ]
      },
      {
        "tool_name": "composition_tool",
        "affordances": [
          {
            "affordance_name": "compose",
            "call_code": "result = tool.compose(plan=params['plan'], return_key=params.get('return_key'))"
          }
        ]
      },
      {
        "tool_name": "perception_router",
        "affordances": [
          {
            "affordance_name": "strip_sign",
            "call_code": "result = tool.strip_sign(params['token'])"
          }
        ]
      }
    ]
  },
  "sequence_spec": {
    "steps": [
      {
        "step_index": 1,
        "affordance": "perception_router.strip_sign",
        "params": {
          "token": {"__type__": "MetaValue", "key": "states.vertical"}
        },
        "result_key": "raw_script_path"
      },
      {
        "step_index": 2,
        "affordance": "file_system.read_now",
        "params": {
          "path": {"__type__": "MetaValue", "key": "raw_script_path"}
        },
        "result_key": "script_read_result"
      },
      {
        "step_index": 3,
        "affordance": "formatter_tool.extract_content",
        "params": {
          "data": {"__type__": "MetaValue", "key": "script_read_result"}
        },
        "result_key": "script_content"
      },
      {
        "step_index": 4,
        "affordance": "python_interpreter.create_function_executor",
        "params": {
          "script": {"__type__": "MetaValue", "key": "script_content"},
          "function_name": "main"
        },
        "result_key": "execute_fn"
      },
      {
        "step_index": 5,
        "affordance": "formatter_tool.wrap_list",
        "params": {},
        "result_key": "wrap_list_fn"
      },
      {
        "step_index": 6,
        "affordance": "composition_tool.compose",
        "params": {
          "plan": [
            {
              "output_key": "execution_result",
              "function": {"__type__": "MetaValue", "key": "execute_fn"},
              "params": {"__positional__": "__initial_input__"}
            },
            {
              "output_key": "final_result",
              "function": {"__type__": "MetaValue", "key": "wrap_list_fn"},
              "params": {"__positional__": "execution_result"},
              "literal_params": {"type": "literal"}
            }
          ],
          "return_key": "final_result"
        },
        "result_key": "instruction_fn"
      }
    ]
  }
}

