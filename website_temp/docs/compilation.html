<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NormCode Compilation Pipeline - How natural language transforms into executable AI plans through progressive formalization.">
    <link rel="icon" type="image/png" href="../Psylensai_log_raw.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../nav.css">
    <link rel="stylesheet" href="styles.css">
    <title>Compilation Pipeline - NormCode è§„èŒƒç </title>
</head>
<body>
    <!-- Navigation will be loaded by load-nav.js -->

    <!-- Page Header -->
    <header class="page-header">
        <h1 data-i18n="page.title">Compilation Pipeline</h1>
        <p data-i18n="page.subtitle">How natural language transforms into executable AI plans through progressive formalization.</p>
    </header>

    <!-- Main Content -->
    <main>
        <div class="breadcrumb">
            <a href="../how-it-works.html" data-i18n="nav.docs">Documentation</a>
            <span>â€º</span>
            <span data-i18n="page.title">Compilation Pipeline</span>
        </div>

        <!-- Pipeline Overview -->
        <section>
            <h2 data-i18n="section.pipeline">The 4-Phase Pipeline</h2>
            <p data-i18n="section.pipelineDesc">NormCode progressively formalizes intent into structure. Each phase answers a specific question while preserving semantic intent.</p>
            
            <div class="pipeline-diagram">
                <div class="pipeline-step">
                    <div class="pipeline-step-label input">
                        Instruction â†’ <em>WHAT</em> and <em>WHY</em>
                    </div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label phase">
                        Phase 1: Derivation
                    </div>
                    <div class="pipeline-step-comment" data-i18n="pipeline.derivationComment">Determine execution order</div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label output">
                        <span class="file-ext">.ncds</span> <span class="comment">(draft straightforward)</span>
                    </div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label phase">
                        Phase 2: Formalization
                    </div>
                    <div class="pipeline-step-comment" data-i18n="pipeline.formalizationComment">Grammar consistency check</div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label output">
                        <span class="file-ext">.ncd</span> <span class="comment">(with flow indices and sequences)</span>
                    </div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label phase">
                        Phase 3: Post-Formalization
                    </div>
                    <div class="pipeline-step-comment" data-i18n="pipeline.postFormalizationComment">Contextualization + resource demand</div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label output">
                        <span class="file-ext">.ncd</span> <span class="comment">(enriched with annotations)</span>
                    </div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label phase">
                        Phase 4: Activation
                    </div>
                    <div class="pipeline-step-comment" data-i18n="pipeline.activationComment">Resolve actual resources + executables</div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label output">
                        <span class="file-ext">.concept.json</span> + <span class="file-ext">.inference.json</span>
                    </div>
                </div>
                
                <div class="pipeline-step">
                    <div class="pipeline-step-label final">
                        Orchestrator Execution
                    </div>
                </div>
            </div>
        </section>

        <!-- What Each Phase Does -->
        <section>
            <h2 data-i18n="section.phases">What Each Phase Does</h2>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="table.phase">Phase</th>
                            <th data-i18n="table.question">Question Answered</th>
                            <th data-i18n="table.input">Input</th>
                            <th data-i18n="table.output">Output</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Instruction</strong></td>
                            <td data-i18n="phase.instructionQ"><em>What</em> and <em>why</em>?</td>
                            <td data-i18n="phase.instructionIn">User intent</td>
                            <td data-i18n="phase.instructionOut">Natural language</td>
                        </tr>
                        <tr>
                            <td><strong data-i18n="phase.derivation">Derivation</strong></td>
                            <td data-i18n="phase.derivationQ"><em>In what order</em>?</td>
                            <td data-i18n="phase.derivationIn">Natural language</td>
                            <td><code class="inline-code">.ncds</code></td>
                        </tr>
                        <tr>
                            <td><strong data-i18n="phase.formalization">Formalization</strong></td>
                            <td data-i18n="phase.formalizationQ">Grammar consistency check</td>
                            <td><code class="inline-code">.ncds</code></td>
                            <td><code class="inline-code">.ncd</code></td>
                        </tr>
                        <tr>
                            <td><strong data-i18n="phase.postFormalization">Post-Formalization</strong></td>
                            <td data-i18n="phase.postFormalizationQ">Contextualization + resource demand</td>
                            <td><code class="inline-code">.ncd</code></td>
                            <td><code class="inline-code">.ncd</code> <span data-i18n="phase.enriched">(enriched)</span></td>
                        </tr>
                        <tr>
                            <td><strong data-i18n="phase.activation">Activation</strong></td>
                            <td data-i18n="phase.activationQ">Actual resources + executables</td>
                            <td><code class="inline-code">.ncd</code> <span data-i18n="phase.enriched">(enriched)</span></td>
                            <td data-i18n="phase.activationOut">JSON repositories</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Phase 1: Derivation -->
        <section>
            <h2 data-i18n="section.derivation">Phase 1: Derivation</h2>
            <p data-i18n="section.derivationDesc">Determine execution order by transforming the instruction into a hierarchical inference structure.</p>
            
            <h3 data-i18n="section.derivationWhat">What It Does</h3>
            <ul>
                <li data-i18n="deriv.concepts">Identifies <strong>concepts</strong> (data entities)</li>
                <li data-i18n="deriv.operations">Identifies <strong>operations</strong> (actions to perform)</li>
                <li data-i18n="deriv.deps">Extracts dependencies (which concepts feed into which operations)</li>
                <li data-i18n="deriv.tree">Creates hierarchical tree structure</li>
            </ul>

            <h3 data-i18n="section.derivationExample">Example</h3>
            <p class="code-label" data-i18n="label.input">Input (Natural Language)</p>
            <div class="code-example">
                <code data-i18n-html="code.derivInput">
"Summarize this document by first cleaning it and then extracting key points."
                </code>
            </div>

            <p class="code-label" data-i18n="label.output">Output (.ncds)</p>
            <div class="code-example">
                <code data-i18n-html="code.derivOutput">
&lt;- document summary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;= summarize this text<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;- clean text<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= extract main content, removing headers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- raw document
                </code>
            </div>

            <div class="info-box">
                <p data-i18n="deriv.note"><strong>Key features:</strong> Bottom-up reading, simple markers (<code class="inline-code">&lt;-</code>, <code class="inline-code">&lt;=</code>), natural language descriptions. No flow indices or sequence types yet.</p>
            </div>
        </section>

        <!-- Phase 2: Formalization -->
        <section>
            <h2 data-i18n="section.formalization">Phase 2: Formalization</h2>
            <p data-i18n="section.formalizationDesc">Grammar consistency checkâ€”add structural rigor to ensure the plan conforms to NormCode grammar.</p>
            
            <h3 data-i18n="section.formalizationWhat">What It Adds</h3>
            <ul>
                <li data-i18n="form.flowIdx"><strong>Unique flow indices</strong> (e.g., <code class="inline-code">1.2.3</code>) to every step</li>
                <li data-i18n="form.seqTypes"><strong>Sequence types</strong> for each inference (imperative, grouping, timing, looping)</li>
                <li data-i18n="form.bindings"><strong>Value bindings</strong> (<code class="inline-code">&lt;:{1}&gt;</code>, <code class="inline-code">&lt;:{2}&gt;</code>) for input ordering</li>
                <li data-i18n="form.metadata"><strong>Metadata comments</strong> (<code class="inline-code">?{sequence}:</code>, <code class="inline-code">?{flow_index}:</code>)</li>
            </ul>

            <h3 data-i18n="section.formalizationExample">Example</h3>
            <p class="code-label" data-i18n="label.output">Output (.ncd)</p>
            <div class="code-example">
                <code data-i18n-html="code.formOutput">
:<span class="variable">:{document summary}</span> | <span class="comment">?{flow_index}: 1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(summarize this text)</span> | <span class="comment">?{flow_index}: 1.1 | ?{sequence}: imperative</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{clean text}</span> | <span class="comment">?{flow_index}: 1.2</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(extract main content)</span> | <span class="comment">?{flow_index}: 1.2.1 | ?{sequence}: imperative</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{raw document}</span> | <span class="comment">?{flow_index}: 1.2.1.1</span>
                </code>
            </div>

            <div class="info-box">
                <p data-i18n="form.note"><strong>Key changes:</strong> Every line has a flow index. Functional concepts have sequence types. Root concept marked with <code class="inline-code">:&lt;:</code>. Semantic types added (<code class="inline-code">{}</code> for objects, <code class="inline-code">::()</code> for imperatives).</p>
            </div>
        </section>

        <!-- Phase 3: Post-Formalization -->
        <section>
            <h2 data-i18n="section.postFormalization">Phase 3: Post-Formalization</h2>
            <p data-i18n="section.postFormalizationDesc">Contextualization and resource demandâ€”declare what resources are needed and where to find them.</p>
            
            <h3 data-i18n="section.postFormThree">Three Sub-Phases</h3>
            
            <div class="card-grid">
                <div class="card">
                    <span class="card-icon">ğŸ”—</span>
                    <h3 data-i18n="post.recomp">Re-composition</h3>
                    <p data-i18n="post.recompDesc">Maps abstract intent to normative context: paradigms, body faculties, perception norms.</p>
                </div>
                <div class="card">
                    <span class="card-icon">ğŸ“</span>
                    <h3 data-i18n="post.provision">Provision</h3>
                    <p data-i18n="post.provisionDesc">Links to concrete resources: file paths, prompt templates, script locations.</p>
                </div>
                <div class="card">
                    <span class="card-icon">ğŸ“</span>
                    <h3 data-i18n="post.syntax">Syntax Re-confirmation</h3>
                    <p data-i18n="post.syntaxDesc">Ensures tensor coherence: axes, shape, element types for reference structure.</p>
                </div>
            </div>

            <h3 data-i18n="section.annotationsAdded">Annotations Added</h3>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="table.annotation">Annotation</th>
                            <th data-i18n="table.purpose">Purpose</th>
                            <th data-i18n="table.example">Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code class="inline-code">%{norm_input}:</code></td>
                            <td data-i18n="annot.paradigm">Paradigm ID to load</td>
                            <td><code class="inline-code">h_PromptTemplate-c_Generate-o_Text</code></td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">%{body_faculty}:</code></td>
                            <td data-i18n="annot.faculty">Body faculty to invoke</td>
                            <td><code class="inline-code">llm</code>, <code class="inline-code">file_system</code></td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">%{ref_axes}:</code></td>
                            <td data-i18n="annot.axes">Named axes for tensors</td>
                            <td><code class="inline-code">[signal]</code>, <code class="inline-code">[_none_axis]</code></td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">%{file_location}:</code></td>
                            <td data-i18n="annot.file">Path to ground data</td>
                            <td><code class="inline-code">provision/data/input.json</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Phase 4: Activation -->
        <section>
            <h2 data-i18n="section.activation">Phase 4: Activation</h2>
            <p data-i18n="section.activationDesc">Resolve actual resources and executablesâ€”validate, load, and include concrete resources in JSON repositories.</p>
            
            <h3 data-i18n="section.activationWhat">What It Produces</h3>
            
            <div class="card-grid">
                <div class="card">
                    <span class="card-icon">ğŸ“¦</span>
                    <h3 data-i18n="activ.concept">concept_repo.json</h3>
                    <p data-i18n="activ.conceptDesc">All concept definitions with types, ground flags, axes, and initial data.</p>
                </div>
                <div class="card">
                    <span class="card-icon">âš™ï¸</span>
                    <h3 data-i18n="activ.inference">inference_repo.json</h3>
                    <p data-i18n="activ.inferenceDesc">All inference definitions with working_interpretation for each sequence.</p>
                </div>
            </div>

            <h3 data-i18n="section.sampleOutput">Sample Output Structure</h3>
            <p class="code-label">concept_repo.json</p>
            <div class="code-example">
                <code>
[<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"concept_name"</span>: <span class="string">"{document summary}"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"type"</span>: <span class="string">"{}"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"is_ground_concept"</span>: <span class="keyword">false</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"is_final_concept"</span>: <span class="keyword">true</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"reference_axis_names"</span>: [<span class="string">"_none_axis"</span>]<br>
&nbsp;&nbsp;}<br>
]
                </code>
            </div>

            <p class="code-label">inference_repo.json</p>
            <div class="code-example">
                <code>
[<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"flow_info"</span>: {<span class="string">"flow_index"</span>: <span class="string">"1.1"</span>},<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"inference_sequence"</span>: <span class="string">"imperative"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"concept_to_infer"</span>: <span class="string">"{document summary}"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"function_concept"</span>: <span class="string">::(summarize this text)"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"value_concepts"</span>: [<span class="string">"{clean text}"</span>],<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"working_interpretation"</span>: {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"paradigm"</span>: <span class="string">"h_PromptTemplate-c_Generate-o_Text"</span>,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"value_order"</span>: {<span class="string">"{clean text}"</span>: 1}<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}<br>
]
                </code>
            </div>

            <div class="info-box success">
                <p data-i18n="activ.note"><strong>Key insight:</strong> The <code class="inline-code">working_interpretation</code> dict contains exactly what each sequence's IWI (Input Working Interpretation) step needs to execute.</p>
            </div>
        </section>

        <!-- Format Ecosystem -->
        <section>
            <h2 data-i18n="section.formats">Format Ecosystem</h2>
            <p data-i18n="section.formatsDesc">Different representations for different purposes throughout the pipeline.</p>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="table.format">Format</th>
                            <th data-i18n="table.purpose">Purpose</th>
                            <th data-i18n="table.createdBy">Created By</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code class="inline-code">.ncds</code></td>
                            <td data-i18n="fmt.ncds">Draft (easiest to write)</td>
                            <td data-i18n="fmt.ncdsBy">You or LLM</td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">.ncd</code></td>
                            <td data-i18n="fmt.ncd">Formal syntax</td>
                            <td data-i18n="fmt.ncdBy">Compiler</td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">.ncn</code></td>
                            <td data-i18n="fmt.ncn">Natural language companion</td>
                            <td data-i18n="fmt.ncnBy">Compiler</td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">.ncdn</code></td>
                            <td data-i18n="fmt.ncdn">Hybrid (NCD + NCN together)</td>
                            <td data-i18n="fmt.ncdnBy">Editor tools</td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">.concept.json</code></td>
                            <td data-i18n="fmt.concept">Concept repository</td>
                            <td data-i18n="fmt.conceptBy">Activation</td>
                        </tr>
                        <tr>
                            <td><code class="inline-code">.inference.json</code></td>
                            <td data-i18n="fmt.inference">Inference repository</td>
                            <td data-i18n="fmt.inferenceBy">Activation</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Key Concepts -->
        <section>
            <h2 data-i18n="section.keyConcepts">Key Compilation Concepts</h2>
            
            <h3 data-i18n="key.flowIdx">Flow Indices</h3>
            <p data-i18n="key.flowIdxDesc">Hierarchical addresses for every step in the plan. Format: <code class="inline-code">1.2.3</code> where each number is a level in the tree.</p>
            <div class="code-example">
                <code data-i18n-html="code.flowIndex">
<span class="string">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Root concept</span><br>
â”œâ”€â”€ <span class="string">1.1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Functional concept (operation)</span><br>
â”œâ”€â”€ <span class="string">1.2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Value concept (first input)</span><br>
â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1</span>&nbsp;<span class="comment"># Nested functional concept</span><br>
â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1.1</span>&nbsp;<span class="comment"># Nested value concept</span><br>
â”œâ”€â”€ <span class="string">1.3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Value concept (second input)</span>
                </code>
            </div>

            <h3 data-i18n="key.seqTypes">Sequence Types</h3>
            <p data-i18n="key.seqTypesDesc">Categories of operations that determine execution strategy:</p>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th data-i18n="table.category">Category</th>
                            <th data-i18n="table.types">Types</th>
                            <th data-i18n="table.llm">LLM?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong data-i18n="seq.semantic">Semantic</strong></td>
                            <td><code class="inline-code">imperative</code>, <code class="inline-code">judgement</code></td>
                            <td>âœ… <span data-i18n="seq.yes">Yes</span></td>
                        </tr>
                        <tr>
                            <td><strong data-i18n="seq.syntactic">Syntactic</strong></td>
                            <td><code class="inline-code">assigning</code>, <code class="inline-code">grouping</code>, <code class="inline-code">timing</code>, <code class="inline-code">looping</code></td>
                            <td>âŒ <span data-i18n="seq.no">No (free)</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Compilation Guarantees -->
        <section>
            <h2 data-i18n="section.guarantees">Compilation Guarantees</h2>
            
            <div class="card-grid">
                <div class="card">
                    <span class="card-icon">âœ…</span>
                    <h3 data-i18n="guar.ensured">What Compilation Ensures</h3>
                    <ul style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <li data-i18n="guar.syntax">Syntactic validity</li>
                        <li data-i18n="guar.flow">Flow consistency</li>
                        <li data-i18n="guar.sequence">Sequence completeness</li>
                        <li data-i18n="guar.reference">Reference structure</li>
                        <li data-i18n="guar.working">Working interpretation</li>
                    </ul>
                </div>
                <div class="card">
                    <span class="card-icon">âš ï¸</span>
                    <h3 data-i18n="guar.notEnsured">What It Does NOT Ensure</h3>
                    <ul style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.5rem;">
                        <li data-i18n="guar.notSemantic">Semantic correctness</li>
                        <li data-i18n="guar.notRuntime">Runtime success</li>
                        <li data-i18n="guar.notLogic">Logical soundness</li>
                        <li data-i18n="guar.notOptimal">Optimal performance</li>
                    </ul>
                </div>
            </div>

            <div class="info-box warning">
                <p data-i18n="guar.note"><strong>Key insight:</strong> Compilation validates <em>structure</em>, not <em>intent</em>. The plan might be syntactically perfect but semantically wrong.</p>
            </div>
        </section>

        <!-- Navigation -->
        <section style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border);">
            <div class="card-grid">
                <a href="execution.html" class="card-link">
                    <div class="card">
                        <span class="card-icon">âš™ï¸</span>
                        <h3 data-i18n="prev.execution">Previous: Execution Model</h3>
                        <p data-i18n="prev.executionDesc">How plans run at runtime.</p>
                    </div>
                </a>
                <a href="syntax.html" class="card-link">
                    <div class="card">
                        <span class="card-icon">ğŸ“</span>
                        <h3 data-i18n="next.syntax">Next: Syntax Reference</h3>
                        <p data-i18n="next.syntaxDesc">Learn the markers, concept types, and operators.</p>
                    </div>
                </a>
            </div>
        </section>

        <a href="../how-it-works.html" class="back-link">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span data-i18n="nav.backDocs">Back to Documentation</span>
        </a>
    </main>

    <!-- Footer -->
    <footer>
        <p><strong>NormCode è§„èŒƒç </strong> Â· <a href="https://github.com/GEOGUANSIN/normCode" target="_blank">GitHub</a> Â· <a href="https://arxiv.org/abs/2512.10563" target="_blank" data-i18n="footer.paper">Paper</a></p>
    </footer>

    <script src="../load-nav.js"></script>
    <script>
        const translations = {
            en: {
                nav: {
                    companyName: 'Psylens.AI',
                    home: 'Home',
                    docs: 'Documentation',
                    overview: 'Overview',
                    syntax: 'Syntax Reference',
                    execution: 'Execution Model',
                    compilation: 'Compilation',
                    examples: 'Examples',
                    team: 'Team',
                    backDocs: 'Back to Documentation'
                },
                page: {
                    title: 'Compilation Pipeline',
                    subtitle: 'How natural language transforms into executable AI plans through progressive formalization.'
                },
                section: {
                    pipeline: 'The 4-Phase Pipeline',
                    pipelineDesc: 'NormCode progressively formalizes intent into structure. The instruction defines WHAT and WHY, then each phase adds structure while preserving semantic intent.',
                    phases: 'What Each Phase Does',
                    derivation: 'Phase 1: Derivation',
                    derivationDesc: 'Determine execution order by transforming the instruction into a hierarchical inference structure.',
                    derivationWhat: 'What It Does',
                    derivationExample: 'Example',
                    formalization: 'Phase 2: Formalization',
                    formalizationDesc: 'Grammar consistency checkâ€”add structural rigor to ensure the plan conforms to NormCode grammar.',
                    formalizationWhat: 'What It Adds',
                    formalizationExample: 'Example',
                    postFormalization: 'Phase 3: Post-Formalization',
                    postFormalizationDesc: 'Contextualization and resource demandâ€”declare what resources are needed and where to find them.',
                    postFormThree: 'Three Sub-Phases',
                    annotationsAdded: 'Annotations Added',
                    activation: 'Phase 4: Activation',
                    activationDesc: 'Resolve actual resources and executablesâ€”validate, load, and include concrete resources in JSON repositories.',
                    activationWhat: 'What It Produces',
                    sampleOutput: 'Sample Output Structure',
                    formats: 'Format Ecosystem',
                    formatsDesc: 'Different representations for different purposes throughout the pipeline.',
                    keyConcepts: 'Key Compilation Concepts',
                    guarantees: 'Compilation Guarantees'
                },
                pipeline: {
                    derivationComment: 'Determine execution order',
                    formalizationComment: 'Grammar consistency check',
                    postFormalizationComment: 'Contextualization + resource demand',
                    activationComment: 'Resolve actual resources + executables'
                },
                table: {
                    phase: 'Phase',
                    question: 'Question Answered',
                    input: 'Input',
                    output: 'Output',
                    annotation: 'Annotation',
                    purpose: 'Purpose',
                    example: 'Example',
                    format: 'Format',
                    createdBy: 'Created By',
                    category: 'Category',
                    types: 'Types',
                    llm: 'LLM?'
                },
                phase: {
                    instructionQ: 'What and why?',
                    instructionIn: 'User intent',
                    instructionOut: 'Natural language',
                    derivation: 'Derivation',
                    derivationQ: 'In what order?',
                    derivationIn: 'Natural language',
                    formalization: 'Formalization',
                    formalizationQ: 'Grammar consistency check',
                    postFormalization: 'Post-Formalization',
                    postFormalizationQ: 'Contextualization + resource demand',
                    enriched: '(enriched)',
                    activation: 'Activation',
                    activationQ: 'Actual resources + executables',
                    activationOut: 'JSON repositories'
                },
                label: {
                    input: 'Input (Natural Language)',
                    output: 'Output'
                },
                deriv: {
                    concepts: 'Identifies concepts (data entities)',
                    operations: 'Identifies operations (actions to perform)',
                    deps: 'Extracts dependencies (which concepts feed into which operations)',
                    tree: 'Creates hierarchical tree structure',
                    note: '<strong>Key features:</strong> Bottom-up reading, simple markers (<code class="inline-code">&lt;-</code>, <code class="inline-code">&lt;=</code>), natural language descriptions. No flow indices or sequence types yet.'
                },
                form: {
                    flowIdx: '<strong>Unique flow indices</strong> (e.g., <code class="inline-code">1.2.3</code>) to every step',
                    seqTypes: '<strong>Sequence types</strong> for each inference (imperative, grouping, timing, looping)',
                    bindings: '<strong>Value bindings</strong> (<code class="inline-code">&lt;:{1}&gt;</code>, <code class="inline-code">&lt;:{2}&gt;</code>) for input ordering',
                    metadata: '<strong>Metadata comments</strong> (<code class="inline-code">?{sequence}:</code>, <code class="inline-code">?{flow_index}:</code>)',
                    note: '<strong>Key changes:</strong> Every line has a flow index. Functional concepts have sequence types. Root concept marked with <code class="inline-code">:&lt;:</code>. Semantic types added (<code class="inline-code">{}</code> for objects, <code class="inline-code">::()</code> for imperatives).'
                },
                post: {
                    recomp: 'Re-composition',
                    recompDesc: 'Maps abstract intent to normative context: paradigms, body faculties, perception norms.',
                    provision: 'Provision',
                    provisionDesc: 'Links to concrete resources: file paths, prompt templates, script locations.',
                    syntax: 'Syntax Re-confirmation',
                    syntaxDesc: 'Ensures tensor coherence: axes, shape, element types for reference structure.'
                },
                annot: {
                    paradigm: 'Paradigm ID to load',
                    faculty: 'Body faculty to invoke',
                    axes: 'Named axes for tensors',
                    file: 'Path to ground data'
                },
                activ: {
                    concept: 'concept_repo.json',
                    conceptDesc: 'All concept definitions with types, ground flags, axes, and initial data.',
                    inference: 'inference_repo.json',
                    inferenceDesc: 'All inference definitions with working_interpretation for each sequence.',
                    note: '<strong>Key insight:</strong> The <code class="inline-code">working_interpretation</code> dict contains exactly what each sequence\'s IWI (Input Working Interpretation) step needs to execute.'
                },
                fmt: {
                    ncds: 'Draft (easiest to write)',
                    ncdsBy: 'You or LLM',
                    ncd: 'Formal syntax',
                    ncdBy: 'Compiler',
                    ncn: 'Natural language companion',
                    ncnBy: 'Compiler',
                    ncdn: 'Hybrid (NCD + NCN together)',
                    ncdnBy: 'Editor tools',
                    concept: 'Concept repository',
                    conceptBy: 'Activation',
                    inference: 'Inference repository',
                    inferenceBy: 'Activation'
                },
                key: {
                    flowIdx: 'Flow Indices',
                    flowIdxDesc: 'Hierarchical addresses for every step in the plan. Format: 1.2.3 where each number is a level in the tree.',
                    seqTypes: 'Sequence Types',
                    seqTypesDesc: 'Categories of operations that determine execution strategy:'
                },
                seq: {
                    semantic: 'Semantic',
                    syntactic: 'Syntactic',
                    yes: 'Yes',
                    no: 'No (free)'
                },
                guar: {
                    ensured: 'What Compilation Ensures',
                    syntax: 'Syntactic validity',
                    flow: 'Flow consistency',
                    sequence: 'Sequence completeness',
                    reference: 'Reference structure',
                    working: 'Working interpretation',
                    notEnsured: 'What It Does NOT Ensure',
                    notSemantic: 'Semantic correctness',
                    notRuntime: 'Runtime success',
                    notLogic: 'Logical soundness',
                    notOptimal: 'Optimal performance',
                    note: '<strong>Key insight:</strong> Compilation validates <em>structure</em>, not <em>intent</em>. The plan might be syntactically perfect but semantically wrong.'
                },
                code: {
                    derivInput: '"Summarize this document by first cleaning it and then extracting key points."',
                    derivOutput: '&lt;- document summary<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;= summarize this text<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;- clean text<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= extract main content, removing headers<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- raw document',
                    formOutput: ':<span class="variable">:{document summary}</span> | <span class="comment">?{flow_index}: 1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(summarize this text)</span> | <span class="comment">?{flow_index}: 1.1 | ?{sequence}: imperative</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{clean text}</span> | <span class="comment">?{flow_index}: 1.2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(extract main content)</span> | <span class="comment">?{flow_index}: 1.2.1 | ?{sequence}: imperative</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{raw document}</span> | <span class="comment">?{flow_index}: 1.2.1.1</span>',
                    flowIndex: '<span class="string">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Root concept</span><br>â”œâ”€â”€ <span class="string">1.1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Functional concept (operation)</span><br>â”œâ”€â”€ <span class="string">1.2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Value concept (first input)</span><br>â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1</span>&nbsp;<span class="comment"># Nested functional concept</span><br>â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1.1</span>&nbsp;<span class="comment"># Nested value concept</span><br>â”œâ”€â”€ <span class="string">1.3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># Value concept (second input)</span>'
                },
                prev: {
                    execution: 'Previous: Execution Model',
                    executionDesc: 'How plans run at runtime.'
                },
                next: {
                    syntax: 'Next: Syntax Reference',
                    syntaxDesc: 'Learn the markers, concept types, and operators.'
                },
                footer: {
                    paper: 'Paper'
                }
            },
            zh: {
                nav: {
                    companyName: 'å¿ƒé•œæ™º',
                    home: 'é¦–é¡µ',
                    docs: 'æ–‡æ¡£',
                    overview: 'æ¦‚è¿°',
                    syntax: 'è¯­æ³•å‚è€ƒ',
                    execution: 'æ‰§è¡Œæ¨¡å‹',
                    compilation: 'ç¼–è¯‘æµç¨‹',
                    examples: 'ç¤ºä¾‹',
                    team: 'å›¢é˜Ÿ',
                    backDocs: 'è¿”å›æ–‡æ¡£'
                },
                page: {
                    title: 'ç¼–è¯‘æµç¨‹',
                    subtitle: 'è‡ªç„¶è¯­è¨€å¦‚ä½•é€šè¿‡æ¸è¿›å¼å½¢å¼åŒ–è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„AIè®¡åˆ’ã€‚'
                },
                section: {
                    pipeline: '4é˜¶æ®µæµæ°´çº¿',
                    pipelineDesc: 'NormCodeé€æ­¥å°†æ„å›¾å½¢å¼åŒ–ä¸ºç»“æ„ã€‚æŒ‡ä»¤å®šä¹‰åšä»€ä¹ˆå’Œä¸ºä»€ä¹ˆï¼Œç„¶åæ¯ä¸ªé˜¶æ®µåœ¨ä¿ç•™è¯­ä¹‰æ„å›¾çš„åŒæ—¶å¢åŠ ç»“æ„ã€‚',
                    phases: 'æ¯ä¸ªé˜¶æ®µçš„ä½œç”¨',
                    derivation: 'é˜¶æ®µ1ï¼šæ¨å¯¼',
                    derivationDesc: 'é€šè¿‡å°†æŒ‡ä»¤è½¬æ¢ä¸ºå±‚æ¬¡åŒ–æ¨ç†ç»“æ„æ¥ç¡®å®šæ‰§è¡Œé¡ºåºã€‚',
                    derivationWhat: 'å®ƒåšä»€ä¹ˆ',
                    derivationExample: 'ç¤ºä¾‹',
                    formalization: 'é˜¶æ®µ2ï¼šå½¢å¼åŒ–',
                    formalizationDesc: 'è¯­æ³•ä¸€è‡´æ€§æ£€æŸ¥â€”â€”æ·»åŠ ç»“æ„ä¸¥è°¨æ€§ä»¥ç¡®ä¿è®¡åˆ’ç¬¦åˆNormCodeè¯­æ³•ã€‚',
                    formalizationWhat: 'å®ƒæ·»åŠ ä»€ä¹ˆ',
                    formalizationExample: 'ç¤ºä¾‹',
                    postFormalization: 'é˜¶æ®µ3ï¼šåå½¢å¼åŒ–',
                    postFormalizationDesc: 'ä¸Šä¸‹æ–‡åŒ–å’Œèµ„æºéœ€æ±‚â€”â€”å£°æ˜éœ€è¦ä»€ä¹ˆèµ„æºä»¥åŠåœ¨å“ªé‡Œæ‰¾åˆ°å®ƒä»¬ã€‚',
                    postFormThree: 'ä¸‰ä¸ªå­é˜¶æ®µ',
                    annotationsAdded: 'æ·»åŠ çš„æ³¨é‡Š',
                    activation: 'é˜¶æ®µ4ï¼šæ¿€æ´»',
                    activationDesc: 'è§£æå®é™…èµ„æºå’Œå¯æ‰§è¡Œæ–‡ä»¶â€”â€”éªŒè¯ã€åŠ è½½å¹¶åœ¨JSONå­˜å‚¨åº“ä¸­åŒ…å«å…·ä½“èµ„æºã€‚',
                    activationWhat: 'å®ƒäº§ç”Ÿä»€ä¹ˆ',
                    sampleOutput: 'ç¤ºä¾‹è¾“å‡ºç»“æ„',
                    formats: 'æ ¼å¼ç”Ÿæ€ç³»ç»Ÿ',
                    formatsDesc: 'åœ¨æ•´ä¸ªæµæ°´çº¿ä¸­ç”¨äºä¸åŒç›®çš„çš„ä¸åŒè¡¨ç¤ºã€‚',
                    keyConcepts: 'å…³é”®ç¼–è¯‘æ¦‚å¿µ',
                    guarantees: 'ç¼–è¯‘ä¿è¯'
                },
                pipeline: {
                    derivationComment: 'ç¡®å®šæ‰§è¡Œé¡ºåº',
                    formalizationComment: 'è¯­æ³•ä¸€è‡´æ€§æ£€æŸ¥',
                    postFormalizationComment: 'ä¸Šä¸‹æ–‡åŒ– + èµ„æºéœ€æ±‚',
                    activationComment: 'è§£æå®é™…èµ„æº + å¯æ‰§è¡Œæ–‡ä»¶'
                },
                table: {
                    phase: 'é˜¶æ®µ',
                    question: 'å›ç­”çš„é—®é¢˜',
                    input: 'è¾“å…¥',
                    output: 'è¾“å‡º',
                    annotation: 'æ³¨é‡Š',
                    purpose: 'ç”¨é€”',
                    example: 'ç¤ºä¾‹',
                    format: 'æ ¼å¼',
                    createdBy: 'åˆ›å»ºè€…',
                    category: 'ç±»åˆ«',
                    types: 'ç±»å‹',
                    llm: 'LLMï¼Ÿ'
                },
                phase: {
                    instructionQ: 'åšä»€ä¹ˆå’Œä¸ºä»€ä¹ˆï¼Ÿ',
                    instructionIn: 'ç”¨æˆ·æ„å›¾',
                    instructionOut: 'è‡ªç„¶è¯­è¨€',
                    derivation: 'æ¨å¯¼',
                    derivationQ: 'ä»€ä¹ˆé¡ºåºï¼Ÿ',
                    derivationIn: 'è‡ªç„¶è¯­è¨€',
                    formalization: 'å½¢å¼åŒ–',
                    formalizationQ: 'è¯­æ³•ä¸€è‡´æ€§æ£€æŸ¥',
                    postFormalization: 'åå½¢å¼åŒ–',
                    postFormalizationQ: 'ä¸Šä¸‹æ–‡åŒ– + èµ„æºéœ€æ±‚',
                    enriched: 'ï¼ˆä¸°å¯Œçš„ï¼‰',
                    activation: 'æ¿€æ´»',
                    activationQ: 'å®é™…èµ„æº + å¯æ‰§è¡Œæ–‡ä»¶',
                    activationOut: 'JSONå­˜å‚¨åº“'
                },
                label: {
                    input: 'è¾“å…¥ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰',
                    output: 'è¾“å‡º'
                },
                deriv: {
                    concepts: 'è¯†åˆ«æ¦‚å¿µï¼ˆæ•°æ®å®ä½“ï¼‰',
                    operations: 'è¯†åˆ«æ“ä½œï¼ˆè¦æ‰§è¡Œçš„åŠ¨ä½œï¼‰',
                    deps: 'æå–ä¾èµ–å…³ç³»ï¼ˆå“ªäº›æ¦‚å¿µæµå…¥å“ªäº›æ“ä½œï¼‰',
                    tree: 'åˆ›å»ºå±‚æ¬¡æ ‘ç»“æ„',
                    note: '<strong>å…³é”®ç‰¹æ€§ï¼š</strong>è‡ªä¸‹è€Œä¸Šé˜…è¯»ï¼Œç®€å•æ ‡è®°ï¼ˆ<code class="inline-code">&lt;-</code>ï¼Œ<code class="inline-code">&lt;=</code>ï¼‰ï¼Œè‡ªç„¶è¯­è¨€æè¿°ã€‚è¿˜æ²¡æœ‰æµç¨‹ç´¢å¼•æˆ–åºåˆ—ç±»å‹ã€‚'
                },
                form: {
                    flowIdx: '<strong>å”¯ä¸€æµç¨‹ç´¢å¼•</strong>ï¼ˆä¾‹å¦‚ï¼Œ<code class="inline-code">1.2.3</code>ï¼‰åˆ°æ¯ä¸ªæ­¥éª¤',
                    seqTypes: '<strong>åºåˆ—ç±»å‹</strong>ç”¨äºæ¯ä¸ªæ¨ç†ï¼ˆç¥ˆä½¿å¼ã€åˆ†ç»„ã€æ—¶åºã€å¾ªç¯ï¼‰',
                    bindings: '<strong>å€¼ç»‘å®š</strong>ï¼ˆ<code class="inline-code">&lt;:{1}&gt;</code>ï¼Œ<code class="inline-code">&lt;:{2}&gt;</code>ï¼‰ç”¨äºè¾“å…¥æ’åº',
                    metadata: '<strong>å…ƒæ•°æ®æ³¨é‡Š</strong>ï¼ˆ<code class="inline-code">?{sequence}:</code>ï¼Œ<code class="inline-code">?{flow_index}:</code>ï¼‰',
                    note: '<strong>å…³é”®å˜åŒ–ï¼š</strong>æ¯è¡Œéƒ½æœ‰æµç¨‹ç´¢å¼•ã€‚åŠŸèƒ½æ¦‚å¿µæœ‰åºåˆ—ç±»å‹ã€‚æ ¹æ¦‚å¿µç”¨<code class="inline-code">:&lt;:</code>æ ‡è®°ã€‚æ·»åŠ äº†è¯­ä¹‰ç±»å‹ï¼ˆå¯¹è±¡ç”¨<code class="inline-code">{}</code>ï¼Œç¥ˆä½¿å¼ç”¨<code class="inline-code">::()</code>ï¼‰ã€‚'
                },
                post: {
                    recomp: 'é‡ç»„',
                    recompDesc: 'å°†æŠ½è±¡æ„å›¾æ˜ å°„åˆ°è§„èŒƒä¸Šä¸‹æ–‡ï¼šèŒƒå¼ã€ä¸»ä½“èƒ½åŠ›ã€æ„ŸçŸ¥è§„èŒƒã€‚',
                    provision: 'é…ç½®',
                    provisionDesc: 'é“¾æ¥åˆ°å…·ä½“èµ„æºï¼šæ–‡ä»¶è·¯å¾„ã€æç¤ºæ¨¡æ¿ã€è„šæœ¬ä½ç½®ã€‚',
                    syntax: 'è¯­æ³•å†ç¡®è®¤',
                    syntaxDesc: 'ç¡®ä¿å¼ é‡ä¸€è‡´æ€§ï¼šè½´ã€å½¢çŠ¶ã€å¼•ç”¨ç»“æ„çš„å…ƒç´ ç±»å‹ã€‚'
                },
                annot: {
                    paradigm: 'è¦åŠ è½½çš„èŒƒå¼ID',
                    faculty: 'è¦è°ƒç”¨çš„ä¸»ä½“èƒ½åŠ›',
                    axes: 'å¼ é‡çš„å‘½åè½´',
                    file: 'åŸºç¡€æ•°æ®çš„è·¯å¾„'
                },
                activ: {
                    concept: 'concept_repo.json',
                    conceptDesc: 'æ‰€æœ‰æ¦‚å¿µå®šä¹‰ï¼ŒåŒ…å«ç±»å‹ã€åŸºç¡€æ ‡å¿—ã€è½´å’Œåˆå§‹æ•°æ®ã€‚',
                    inference: 'inference_repo.json',
                    inferenceDesc: 'æ‰€æœ‰æ¨ç†å®šä¹‰ï¼ŒåŒ…å«æ¯ä¸ªåºåˆ—çš„working_interpretationã€‚',
                    note: '<strong>å…³é”®è§è§£ï¼š</strong><code class="inline-code">working_interpretation</code>å­—å…¸åŒ…å«æ¯ä¸ªåºåˆ—çš„IWIï¼ˆè¾“å…¥å·¥ä½œè§£é‡Šï¼‰æ­¥éª¤æ‰§è¡Œæ‰€éœ€çš„ç¡®åˆ‡å†…å®¹ã€‚'
                },
                fmt: {
                    ncds: 'è‰ç¨¿ï¼ˆæœ€æ˜“ç¼–å†™ï¼‰',
                    ncdsBy: 'æ‚¨æˆ–LLM',
                    ncd: 'æ­£å¼è¯­æ³•',
                    ncdBy: 'ç¼–è¯‘å™¨',
                    ncn: 'è‡ªç„¶è¯­è¨€ä¼´éš',
                    ncnBy: 'ç¼–è¯‘å™¨',
                    ncdn: 'æ··åˆï¼ˆNCD + NCNä¸€èµ·ï¼‰',
                    ncdnBy: 'ç¼–è¾‘å™¨å·¥å…·',
                    concept: 'æ¦‚å¿µå­˜å‚¨åº“',
                    conceptBy: 'æ¿€æ´»',
                    inference: 'æ¨ç†å­˜å‚¨åº“',
                    inferenceBy: 'æ¿€æ´»'
                },
                key: {
                    flowIdx: 'æµç¨‹ç´¢å¼•',
                    flowIdxDesc: 'è®¡åˆ’ä¸­æ¯ä¸ªæ­¥éª¤çš„å±‚æ¬¡åœ°å€ã€‚æ ¼å¼ï¼š1.2.3ï¼Œå…¶ä¸­æ¯ä¸ªæ•°å­—æ˜¯æ ‘ä¸­çš„ä¸€ä¸ªçº§åˆ«ã€‚',
                    seqTypes: 'åºåˆ—ç±»å‹',
                    seqTypesDesc: 'å†³å®šæ‰§è¡Œç­–ç•¥çš„æ“ä½œç±»åˆ«ï¼š'
                },
                seq: {
                    semantic: 'è¯­ä¹‰',
                    syntactic: 'è¯­æ³•',
                    yes: 'æ˜¯',
                    no: 'å¦ï¼ˆå…è´¹ï¼‰'
                },
                guar: {
                    ensured: 'ç¼–è¯‘ç¡®ä¿ä»€ä¹ˆ',
                    syntax: 'è¯­æ³•æœ‰æ•ˆæ€§',
                    flow: 'æµç¨‹ä¸€è‡´æ€§',
                    sequence: 'åºåˆ—å®Œæ•´æ€§',
                    reference: 'å¼•ç”¨ç»“æ„',
                    working: 'å·¥ä½œè§£é‡Š',
                    notEnsured: 'å®ƒä¸ç¡®ä¿ä»€ä¹ˆ',
                    notSemantic: 'è¯­ä¹‰æ­£ç¡®æ€§',
                    notRuntime: 'è¿è¡Œæ—¶æˆåŠŸ',
                    notLogic: 'é€»è¾‘å¥å…¨æ€§',
                    notOptimal: 'æœ€ä½³æ€§èƒ½',
                    note: '<strong>å…³é”®è§è§£ï¼š</strong>ç¼–è¯‘éªŒè¯<em>ç»“æ„</em>ï¼Œè€Œé<em>æ„å›¾</em>ã€‚è®¡åˆ’å¯èƒ½åœ¨è¯­æ³•ä¸Šå®Œç¾ï¼Œä½†åœ¨è¯­ä¹‰ä¸Šæ˜¯é”™è¯¯çš„ã€‚'
                },
                code: {
                    derivInput: '"é€šè¿‡é¦–å…ˆæ¸…ç†æ–‡æ¡£ç„¶åæå–å…³é”®ç‚¹æ¥æ€»ç»“è¿™ç¯‡æ–‡æ¡£ã€‚"',
                    derivOutput: '&lt;- æ–‡æ¡£æ‘˜è¦<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;= æ€»ç»“æ­¤æ–‡æœ¬<br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;- æ¸…ç†åçš„æ–‡æœ¬<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= æå–ä¸»è¦å†…å®¹ï¼Œç§»é™¤æ ‡é¢˜<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- åŸå§‹æ–‡æ¡£',
                    formOutput: ':<span class="variable">:{æ–‡æ¡£æ‘˜è¦}</span> | <span class="comment">?{flow_index}: 1</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(æ€»ç»“æ­¤æ–‡æœ¬)</span> | <span class="comment">?{flow_index}: 1.1 | ?{sequence}: imperative</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{æ¸…ç†åçš„æ–‡æœ¬}</span> | <span class="comment">?{flow_index}: 1.2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;= <span class="function">::(æå–ä¸»è¦å†…å®¹)</span> | <span class="comment">?{flow_index}: 1.2.1 | ?{sequence}: imperative</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;- <span class="variable">{åŸå§‹æ–‡æ¡£}</span> | <span class="comment">?{flow_index}: 1.2.1.1</span>',
                    flowIndex: '<span class="string">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># æ ¹æ¦‚å¿µ</span><br>â”œâ”€â”€ <span class="string">1.1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># åŠŸèƒ½æ¦‚å¿µï¼ˆæ“ä½œï¼‰</span><br>â”œâ”€â”€ <span class="string">1.2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># å€¼æ¦‚å¿µï¼ˆç¬¬ä¸€ä¸ªè¾“å…¥ï¼‰</span><br>â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1</span>&nbsp;<span class="comment"># åµŒå¥—åŠŸèƒ½æ¦‚å¿µ</span><br>â”‚&nbsp;&nbsp;&nbsp;â”œâ”€â”€ <span class="string">1.2.1.1</span>&nbsp;<span class="comment"># åµŒå¥—å€¼æ¦‚å¿µ</span><br>â”œâ”€â”€ <span class="string">1.3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment"># å€¼æ¦‚å¿µï¼ˆç¬¬äºŒä¸ªè¾“å…¥ï¼‰</span>'
                },
                prev: {
                    execution: 'ä¸Šä¸€æ­¥ï¼šæ‰§è¡Œæ¨¡å‹',
                    executionDesc: 'è®¡åˆ’å¦‚ä½•åœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚'
                },
                next: {
                    syntax: 'ä¸‹ä¸€æ­¥ï¼šè¯­æ³•å‚è€ƒ',
                    syntaxDesc: 'å­¦ä¹ æ ‡è®°ã€æ¦‚å¿µç±»å‹å’Œæ“ä½œç¬¦ã€‚'
                },
                footer: {
                    paper: 'è®ºæ–‡'
                }
            }
        };

        let currentLang = localStorage.getItem('lang') || 'en';

        // Expose setLanguage globally so load-nav.js can call it
        window.setLanguage = function(lang) {
            currentLang = lang;
            localStorage.setItem('lang', lang);
            document.documentElement.lang = lang;
            
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                const keys = key.split('.');
                let value = translations[lang];
                
                for (const k of keys) {
                    value = value?.[k];
                }
                
                if (value !== undefined) {
                    if (value.includes('<code') || value.includes('<strong') || value.includes('<em')) {
                        el.innerHTML = value;
                    } else {
                        el.textContent = value;
                    }
                }
            });

            // Handle HTML translations (for code examples)
            document.querySelectorAll('[data-i18n-html]').forEach(el => {
                const key = el.getAttribute('data-i18n-html');
                const keys = key.split('.');
                let value = translations[lang];
                
                for (const k of keys) {
                    value = value?.[k];
                }
                
                if (value !== undefined) {
                    el.innerHTML = value;
                }
            });

            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
            });
        };
        
        setLanguage(currentLang);

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                setLanguage(btn.getAttribute('data-lang'));
            });
        });

        // Mobile menu is handled by load-nav.js
    </script>
</body>
</html>

